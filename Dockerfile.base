# Use uma imagem oficial e slim do Python
FROM python:3.12-slim

# Define o diretório de trabalho dentro do container
WORKDIR /app

# Crie um usuário não-root para segurança
RUN useradd --create-home --shell /bin/bash sakauser
USER sakauser
WORKDIR /home/sakauser/app

# Copia e instala as dependências primeiro para aproveitar o cache do Docker
COPY --chown=sakauser:sakauser requirements.txt .
RUN pip install --no-cache-dir --upgrade pip && \
    pip install --no-cache-dir -r requirements.txt

# Copia toda a estrutura de pacotes 'saka' para a imagem base
COPY --chown=sakauser:sakauser saka/ ./saka

# Expõe a porta padrão que os agentes usarão
EXPOSE 8000